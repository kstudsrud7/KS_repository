// Step 1: Create a new record in 'TONDeliveryOrderHeader' from colPurchaseOrderHeader
Set(
    varHeaderRecordID,
    Patch(
        'TON Delivery Order Headers', 
        Defaults('TON Delivery Order Headers'), 
        {
            // Assuming your 'TONDeliveryOrderHeader' table has these fields
            'Purchase Order': First(colPurchaseOrderHeader).'PO Number',
            Vendor: First(colPurchaseOrderHeader).'Vendor Number',
            Year: First(colPurchaseOrderHeader).Year,
            // Add more fields as necessary
        }
    ).'TON Delivery Order Header' // Capture the ID of the created record
);

// Step 2: Create records in 'TONDeliverOrderLines' from colDeliverOrderLines with a lookup to the header record
//ForAll(
//    colDeliverOrderLines,
//    Patch(
//        'TONDeliverOrderLines',
//        Defaults('TONDeliverOrderLines'),
//        {
//            'Delivery Order Header': varHeaderRecordID, // Lookup to the created header
//            'Line Number': ThisRecord.'Line Number',
//            'Product Name': ThisRecord.'Product Name',
//            'Ordered': ThisRecord.Ordered,
//            'Received': ThisRecord.Received,
//            'Fixed Asset': ThisRecord.'Fixed Asset',
//            'Comment': ThisRecord.Comment
//            // Add more fields as necessary
//        }
//    )
//)


Patch(
    colPurchaseOrderHeader,
    ThisItem,
    {DeliveredBy: DeliveredbyCombo.Selected.Worker}
)

Patch(
    colPurchaseOrderHeader,
    ThisItem,
    {DeliveredTo: DeliveredbyCombo.Selected.Worker}
)